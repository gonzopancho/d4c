D4C
===

DNS DDoS Defence and Countermeasure.

d4c works as non-learning bridge and filter specified DNS packets that 
are suspected as DDoS traffic.


	 % ./d4c 
	 Usage of d4c
	 	 * required options.
	 	-r : Right interface name
	 	-l : Left interface name
	 
	 	 * DNS filtering options.
	 	-m : Filter suffix of DNS Query Name
	 	-d : Destination prefixes of filtered DNS responses
	 	-s : Source prefixes of NOT filtered DNS responses
	 
	 	 * misc.
	 	-q : Max number of threads for interface
	 	-e : Number of Rings of a vale port
	 	-f : Daemon mode
	 	-v : Verbose mode
	 	-h : Print this help


1. Drop DNS response packet from other AS
-----------------------------------------

DNS DDoS traffic is generated by full-open resolvers around the world.
When assuming that "correct DNS responses are sent from correct resolver servers",
DNS responses from resolver servers in other AS are fully incorrect if the correct
resolver is in a same AS with end clients.

So, d4c drop incorrect DNS response packets that match following conditions.

- The packet is DNS response (QR flag is 1).
- The packet is response from a resolver server (Authoritative flag is 0).

However, correct resolver servers exist on other AS such Google public DNS etc.
Moreover, operators sometimes want to apply these filters for specific hosts or 
networks. -d and -s options help this use.

This filtering only works when the packet destination is in the prefixes specified by -d options and the packet source is not in the prefixes specified by -s options.



2. Drop DNS query packet with specified QNAME
---------------------------------------------

Query to generate DDoS traffic often contains striking QNAME.
Dropping these query packets with striking QNAME helps reducing DDoS traffic.
d4c provides a query filter function with QNAME _suffix_ match.
-m options specify QNAME as suffix.

For example, `-m .hoge.com` is specified, query packets contains `.*.hoge.com` 
as QNAME are dropped.



Compile
-------

d4c is a netmap application. netmap.ko and netmap driver for interfaces used by 
d4c must be installed in advance. In order to compile, `netmap.h` and `netmap_user.h`
must be installed on `/usr/include/net/`.
